[id="proc-extensions-enabling-plugins-installation_{context}"]
= Configuring {product-very-short} to install plugins by using Extensions

When you install a plugin, the configuration that you during installing is saved to a dynamic plugins cache to ensure that the same configuration is available when you edit, enable, or disable the plugin. 

You must create a persistent volume cache (PVC) to ensure that the cache persists whne you restart the {product-very-short} application. For more information about using the dynamic plugins cache, see link:https://docs.redhat.com/en/documentation/red_hat_developer_hub/{product-version}/html-single/configuring_red_hat_developer_hub/index#using-the-dynamic-plugins-cache_running-behind-a-proxy[Using the dynamic plugins cache].

.Prequisites
* You have created a persistent volume claim (PVC) for the dynamic plugins cache with the name *dynamic-plugins-route*.
* You have installed Red Hat Developer Hub using the Helm chart.
* You have installed the OpenShift CLI (`oc`).

.Procedure
. Create the marketplace configuration file and save it as `dynamic-plugins.marketplace.yaml`. For example:
+
[source,yaml]
----
plugins:
  - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-marketplace-backend-dynamic
    disabled: false
    pluginConfig:
      extensions:
        installation:
          enabled: true
          saveToSingleFile:
            file: /opt/app-root/src/dynamic-plugins-root/dynamic-plugins.marketplace.yaml
----
. Copy the file to your cluster by running the following commands:
+
[source,yaml]
----
oc get pods -n <your-namespace>

oc cp ./dynamic-plugins.marketplace.yaml <your-namespace>/<pod-name>:/opt/app-root/src/dynamic-plugins-root/dynamic-plugins.marketplace.yaml
----
. Upgrade the Helm release to use this file and update environment variable to development:
+
[source,yaml]
----
global:
 auth:
   backend:
     enabled: true
 clusterRouterBase: apps.rosa.iuosa-vcqyd-ek4.jryo.p3.openshiftapps.com
 dynamic:
   includes:
     - dynamic-plugins.default.yaml
     - /dynamic-plugins-root/dynamic-plugins.marketplace.yaml
upstream:
 backstage:
   extraEnvVars:
     - name: NODE_ENV
       value: development
----
. Click *Upgrade*

. Add the following configuration for the Extensions UI package in your `redhat-developer-hub-dynamic-plugins` config map, to include the newly added mount point:
+
[source,yaml,subs="+attributes"]
----
data:
  dynamic-plugins.yaml: |
    includes:
    - dynamic-plugins.default.yaml
    - /dynamic-plugins-root/dynamic-plugins.marketplace.yaml
    plugins: 
    - package: ./dynamic-plugins/dist/backstage-community-plugin-rbac
    - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-marketplace
      disabled: false
      pluginConfig:
        dynamicPlugins:
            frontend:
            red-hat-developer-hub.backstage-plugin-marketplace:
                appIcons:
                - name: marketplace
                    importName: MarketplaceIcon
                dynamicRoutes:
                - path: /extensions/catalog
                    importName: DynamicMarketplacePluginRouter
                mountPoints:
                - mountPoint: application/provider
                    importName: InstallationContextProvider
                - mountPoint: internal.plugins/tab
                    importName: DynamicMarketplacePluginContent
                    config:
                    path: marketplace
                    title: Catalog
----
. Click *Save*


// .Validation
